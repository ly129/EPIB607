Fig1=TRUE
PDF=TRUE
if(Fig1){
path="/Users/jameshanley/Dropbox/Courses/607/IntroRegression/"
path = "~/Dropbox/mcgill/teaching/EPIB607/Link to Jim2018/IntroRegression/SB_figs/"
K=rep(FALSE,7)
for(k in 0:6){  # layers
if(PDF) pdf(file=paste(path,"Fig1",
toString(k),".pdf",sep=""),
width=10,
height=6.6)
par(mfrow=c(1,3),mar = c(0,0,0,0) )
par(mfrow=c(1,1),mar = c(0,0,0,0) )
PARA=c(expression(mu),
expression(pi),
expression(lambda))
PARA1=c(expression(mu[1]),
expression(pi[1]),
expression(lambda[1]))
PARA0=c(expression(mu[0]),
expression(pi[0]),
expression(lambda[0]))
LINE1=c(expression(mu[1]==mu[0]+Delta),
expression(pi[1]==pi[0]+Delta),
expression(lambda[1]==lambda[0]+Delta))
LINE2=c(expression(paste(mu," = ",
mu[0] + Delta %*%"South")),
expression(paste(pi," = ",
pi[0] + Delta %*%"South")),
expression(paste(lambda," = ",
lambda[0] + Delta %*%"South")) )
LINE3=c(
expression(paste(
theta == frac(mu[1],mu[0]) ," ; ", mu[1] == mu[0] %*% theta)),
expression(paste(
theta == frac(pi[1],pi[0]) ," ; ", pi[1] == pi[0] %*% theta)),
expression(paste(
theta == frac(lambda[1], lambda[0]) ," ; ", lambda[1] == lambda[0] %*% theta))       )
TOP=c("Mean Ocean
depth (Km)",
"Proportion
Water",
"Magnitude 6 or higher
Earthquakes/Month")
LOG =c("Log of
Mean Depth
(base e)",
" Water(W)
:
Land(L)",
"Log
Rate
(base e)")
LOG2 =c("Log of
Mean Depth
(base 2)","log
of
W:L",
"Log
Rate
(base 2)")
L=c(0, 0, 0)
U=c(5.45, 1, 8.25)
dy=c(1,0.1,1)
O = c(10,5:2,1.5,1,2/3,1/(2:4))
P = O/(O+1)
LO = log(O)
xO = -0.6
xLO = -1.2
xL  = -0.6
xL2 = -1.2
xN=0.2
xS=1.2
xR = 1.4
N = c(3.5,.61,5.7)
S = c(4,.82,7.1)
for(i in 1){ # mu, pi, lambda
plot(c(-0.5,1.6),
c(-0.25,1.25),
col="white",yaxt="n",
xlim=c(-1.5,1.40),
ylim=c(-0.20,1.2))
text(0,1.15,PARA[i],
adj=c(0.5,0),cex=4)
text(0,1.05,TOP[i],adj=c(0.5,0),
cex=1.2, font=2)
if(K[2]){
arrows(xN, 0, xS, 0,
code=3,length=0.06,angle=25)
text((xN+xS)/2,-0.04,
expression(paste("'",Delta,x,"' = 1")),
cex=1.5 )
}
if(K[3]){
arrows(xL,-0.03,xL,0.01,length=0.05,angle=18)
arrows(xL2,-0.03,xL2,0.01,
length=0.05,angle=18)
text(xL,-0.04,LOG[i],adj=c(0.5,1))
text(xL2,-0.04,LOG2[i],adj=c(0.5,1))
}
text(xN,-0.1,"NORTH
(South=0)")
text(xS,-0.1,"SOUTH
(South=1)")
segments(0,0,0,1)
y=seq(L[i],U[i],dy[i])
segments(xN,y/U[i],xS,y/U[i],col="lightblue")
segments(xN,0,xS,0)
if(i==2 & K[3]){
for(p in P){
CO = c("black","black","black")[
1*(p<.5)+
2*(p==.5)+
3*(p>.5)]
odds=p/(1-p)
if(p==.25) odds=0.33
if(round(p,2)==.4) odds=0.33
txt = paste(
toString(odds),":1",sep="")
if(K[1]){
text(xO,
p/U[i], txt,
col=CO,adj=c(0.5,0.5))
text(xLO,
p/U[i],
toString(round(log(odds),1)),
adj=c(0.5,0.5),col=CO)
}
if(i!=2){
arrows(0,0,0,1,
length=0.07,angle=25)
if(K[3]){
Lm=seq(0.25,2.0,0.25)
M = exp(Lm)
for(j in 1:length(Lm)) if(
M[j] < U[i]) text(
xL-0.05,
M[j]/U[i],
format(Lm[j],nsmall=1),
adj=c(0.5,0.5))
L2m=c(-1,0,1,1.5,2,2.5,3)
M = 2^L2m
for(j in 1:length(L2m)) if(
M[j] < U[i]) text(
xL2-0.03,
M[j]/U[i],
format(L2m[j],nsmall=1),
adj=c(0.5,0.5))
}
y=seq(L[i],U[i],dy[i])
for(j in 1:length(y)){
text(-0.04,
y[j]/U[i],toString(y[j]),
adj=c(1,0.5))
#text(xR+0.04,
#     y[j]/U[i],toString(y[j]),
#     adj=c(0,0.5))
}
E=PARA1[i]
text(xS,S[i]/U[i],E,font=2,cex=2)
E=PARA0[i]
text(xN,N[i]/U[i],E,font=2,cex=2)
if(K[1]) arrows(2*xN/5+3*xS/5 -0.075,
N[i]/U[i],
2*xN/5+3*xS/5 -0.075,
S[i]/U[i],
length=0.07,angle=25,code=3)
if(K[1]){
text((1*xN/4+3*xS/4)-0.02,
(1/2)*(S[i]+N[i])/U[i],
expression(Delta),cex=2,
adj=c(1,0.5))
text((1*xN/4+3*xS/4)-0.0,
(1/2)*(S[i]+N[i])/U[i] - 0.015,
PARA[i],cex=1.75,
adj=c(0,0.5))
}
if(K[2]){
yy=0.55
rect(xN+0.04,yy+0.03,
xS+0.20,yy-0.07,col="beige",border=NA)
E=LINE1[i]
text(xN+0.07,yy,E,
cex=1.25,
adj=c(0,0.5))
COL="blue"
yy = 0.51
E = LINE2[i]
text(xN+0.07,yy,E,cex=1.25,
adj=c(0,0.5),col=COL)
}
if(K[4]){
yy=0.44
rect(xN+0.04,yy+0.03,
xS+0.2,yy-0.185,col="beige",border=NA)
E = LINE3[i]
text(xN+0.07,yy-0.02,E,cex=1.25,
adj=c(0,0.5))
yy=0.33
E = expression(paste("log(",mu,
") = log(",mu[0],") +"))
if(i==2) E = expression(paste("log(",pi,
") = log(",pi[0],") +"))
if(i==3) E = expression(paste("log(",lambda,
") = log(",lambda[0],") +"))
text(xN+0.07,yy,E,
cex=1.25,
adj=c(0,0.5),col=COL)
yy=0.28
text(xN+0.07,yy,
expression(paste(
"     log(",theta,") x South")),
cex=1.25,
adj=c(0,0.5),col=COL)
}
if(K[5]){
if(i==2){
yy=0.215
rect(xN+0.04,yy+0.03,
xS+0.2,yy-0.21,col="beige",border=NA)
text(xN+0.07,yy-0.03,
expression(paste(
omega == frac(W,L)," = ",frac(1-pi,pi)," ; ",
theta == frac(omega[1],omega[0]) )),
cex=1.1,
adj=c(0,0.5))
E = expression(paste("log(",omega,
") = log(",omega[0],") +"))
text(xN+0.07,yy-0.13,E,
cex=1.25,
adj=c(0,0.5),col=COL)
text(xN+0.07,yy-0.18,
expression(paste(
"     log(",theta,") x South")),
cex=1.25,
adj=c(0,0.5),col=COL)
}
} #K5
# c(-1.5,1.40)
segments( -1.45,-0.17,1.35,-0.17,
lty="dotted")
E=expression(paste(
"fn. of ",mu[x],
" = ",beta[0]," (i.e., this fn. at South = 0) + an additional '", beta,"' if South = 1" ))
if(i==2) E=expression(paste(
"fn. of ",pi[x],
" = ",beta[0]," (i.e., this fn. at South = 0) + an additional '", beta,"' if South = 1" ))
if(i==3) E=expression(paste(
"fn. of ",lambda[x],
" = ",beta[0]," (i.e., this fn. at South = 0) + an additional '", beta,"' if South = 1" ))
if(K[6]) text(-0.05,-0.22,E,cex=0.9,
adj=c(0.5,0.5),col=COL)
}
K[k+1]=TRUE
if(PDF) dev.off()
} # k
} # Fig1
if(Fig1){
path="/Users/jameshanley/Dropbox/Courses/607/IntroRegression/"
path = "~/Dropbox/mcgill/teaching/EPIB607/Link to Jim2018/IntroRegression/SB_figs/"
K=rep(FALSE,7)
for(k in 0:6){  # layers
if(PDF) pdf(file=paste(path,"Fig2",
toString(k),".pdf",sep=""),
width=10,
height=6.6)
par(mfrow=c(1,2),mar = c(0,0,0,0) )
# par(mfrow=c(1,1),mar = c(0,0,0,0) )
PARA=c(expression(mu),
expression(pi),
expression(lambda))
PARA1=c(expression(mu[1]),
expression(pi[1]),
expression(lambda[1]))
PARA0=c(expression(mu[0]),
expression(pi[0]),
expression(lambda[0]))
LINE1=c(expression(mu[1]==mu[0]+Delta),
expression(pi[1]==pi[0]+Delta),
expression(lambda[1]==lambda[0]+Delta))
LINE2=c(expression(paste(mu," = ",
mu[0] + Delta %*%"South")),
expression(paste(pi," = ",
pi[0] + Delta %*%"South")),
expression(paste(lambda," = ",
lambda[0] + Delta %*%"South")) )
LINE3=c(
expression(paste(
theta == frac(mu[1],mu[0]) ," ; ", mu[1] == mu[0] %*% theta)),
expression(paste(
theta == frac(pi[1],pi[0]) ," ; ", pi[1] == pi[0] %*% theta)),
expression(paste(
theta == frac(lambda[1], lambda[0]) ," ; ", lambda[1] == lambda[0] %*% theta))       )
TOP=c("Mean Ocean
depth (Km)",
"Proportion
Water",
"Magnitude 6 or higher
Earthquakes/Month")
LOG =c("Log of
Mean Depth
(base e)",
" Water(W)
:
Land(L)",
"Log
Rate
(base e)")
LOG2 =c("Log of
Mean Depth
(base 2)","log
of
W:L",
"Log
Rate
(base 2)")
L=c(0, 0, 0)
U=c(5.45, 1, 8.25)
dy=c(1,0.1,1)
O = c(10,5:2,1.5,1,2/3,1/(2:4))
P = O/(O+1)
LO = log(O)
xO = -0.6
xLO = -1.2
xL  = -0.6
xL2 = -1.2
xN=0.2
xS=1.2
xR = 1.4
N = c(3.5,.61,5.7)
S = c(4,.82,7.1)
for(i in 2:3){ # mu, pi, lambda
plot(c(-0.5,1.6),
c(-0.25,1.25),
col="white",yaxt="n",
xlim=c(-1.5,1.40),
ylim=c(-0.20,1.2))
text(0,1.15,PARA[i],
adj=c(0.5,0),cex=4)
text(0,1.05,TOP[i],adj=c(0.5,0),
cex=1.2, font=2)
if(K[2]){
arrows(xN, 0, xS, 0,
code=3,length=0.06,angle=25)
text((xN+xS)/2,-0.04,
expression(paste("'",Delta,x,"' = 1")),
cex=1.5 )
}
if(K[3]){
arrows(xL,-0.03,xL,0.01,length=0.05,angle=18)
arrows(xL2,-0.03,xL2,0.01,
length=0.05,angle=18)
text(xL,-0.04,LOG[i],adj=c(0.5,1))
text(xL2,-0.04,LOG2[i],adj=c(0.5,1))
}
text(xN,-0.1,"NORTH
(South=0)")
text(xS,-0.1,"SOUTH
(South=1)")
segments(0,0,0,1)
y=seq(L[i],U[i],dy[i])
segments(xN,y/U[i],xS,y/U[i],col="lightblue")
segments(xN,0,xS,0)
if(i==2 & K[3]){
for(p in P){
CO = c("black","black","black")[
1*(p<.5)+
2*(p==.5)+
3*(p>.5)]
odds=p/(1-p)
if(p==.25) odds=0.33
if(round(p,2)==.4) odds=0.33
txt = paste(
toString(odds),":1",sep="")
if(K[1]){
text(xO,
p/U[i], txt,
col=CO,adj=c(0.5,0.5))
text(xLO,
p/U[i],
toString(round(log(odds),1)),
adj=c(0.5,0.5),col=CO)
}
if(i!=2){
arrows(0,0,0,1,
length=0.07,angle=25)
if(K[3]){
Lm=seq(0.25,2.0,0.25)
M = exp(Lm)
for(j in 1:length(Lm)) if(
M[j] < U[i]) text(
xL-0.05,
M[j]/U[i],
format(Lm[j],nsmall=1),
adj=c(0.5,0.5))
L2m=c(-1,0,1,1.5,2,2.5,3)
M = 2^L2m
for(j in 1:length(L2m)) if(
M[j] < U[i]) text(
xL2-0.03,
M[j]/U[i],
format(L2m[j],nsmall=1),
adj=c(0.5,0.5))
}
y=seq(L[i],U[i],dy[i])
for(j in 1:length(y)){
text(-0.04,
y[j]/U[i],toString(y[j]),
adj=c(1,0.5))
#text(xR+0.04,
#     y[j]/U[i],toString(y[j]),
#     adj=c(0,0.5))
}
E=PARA1[i]
text(xS,S[i]/U[i],E,font=2,cex=2)
E=PARA0[i]
text(xN,N[i]/U[i],E,font=2,cex=2)
if(K[1]) arrows(2*xN/5+3*xS/5 -0.075,
N[i]/U[i],
2*xN/5+3*xS/5 -0.075,
S[i]/U[i],
length=0.07,angle=25,code=3)
if(K[1]){
text((1*xN/4+3*xS/4)-0.02,
(1/2)*(S[i]+N[i])/U[i],
expression(Delta),cex=2,
adj=c(1,0.5))
text((1*xN/4+3*xS/4)-0.0,
(1/2)*(S[i]+N[i])/U[i] - 0.015,
PARA[i],cex=1.75,
adj=c(0,0.5))
}
if(K[2]){
yy=0.55
rect(xN+0.04,yy+0.03,
xS+0.20,yy-0.07,col="beige",border=NA)
E=LINE1[i]
text(xN+0.07,yy,E,
cex=1.25,
adj=c(0,0.5))
COL="blue"
yy = 0.51
E = LINE2[i]
text(xN+0.07,yy,E,cex=1.25,
adj=c(0,0.5),col=COL)
}
if(K[4]){
yy=0.44
rect(xN+0.04,yy+0.03,
xS+0.2,yy-0.185,col="beige",border=NA)
E = LINE3[i]
text(xN+0.07,yy-0.02,E,cex=1.25,
adj=c(0,0.5))
yy=0.33
E = expression(paste("log(",mu,
") = log(",mu[0],") +"))
if(i==2) E = expression(paste("log(",pi,
") = log(",pi[0],") +"))
if(i==3) E = expression(paste("log(",lambda,
") = log(",lambda[0],") +"))
text(xN+0.07,yy,E,
cex=1.25,
adj=c(0,0.5),col=COL)
yy=0.28
text(xN+0.07,yy,
expression(paste(
"     log(",theta,") x South")),
cex=1.25,
adj=c(0,0.5),col=COL)
}
if(K[5]){
if(i==2){
yy=0.215
rect(xN+0.04,yy+0.03,
xS+0.2,yy-0.21,col="beige",border=NA)
text(xN+0.07,yy-0.03,
expression(paste(
omega == frac(W,L)," = ",frac(1-pi,pi)," ; ",
theta == frac(omega[1],omega[0]) )),
cex=1.1,
adj=c(0,0.5))
E = expression(paste("log(",omega,
") = log(",omega[0],") +"))
text(xN+0.07,yy-0.13,E,
cex=1.25,
adj=c(0,0.5),col=COL)
text(xN+0.07,yy-0.18,
expression(paste(
"     log(",theta,") x South")),
cex=1.25,
adj=c(0,0.5),col=COL)
}
} #K5
# c(-1.5,1.40)
segments( -1.45,-0.17,1.35,-0.17,
lty="dotted")
E=expression(paste(
"fn. of ",mu[x],
" = ",beta[0]," (i.e., this fn. at South = 0) + an additional '", beta,"' if South = 1" ))
if(i==2) E=expression(paste(
"fn. of ",pi[x],
" = ",beta[0]," (i.e., this fn. at South = 0) + an additional '", beta,"' if South = 1" ))
if(i==3) E=expression(paste(
"fn. of ",lambda[x],
" = ",beta[0]," (i.e., this fn. at South = 0) + an additional '", beta,"' if South = 1" ))
if(K[6]) text(-0.05,-0.22,E,cex=0.9,
adj=c(0.5,0.5),col=COL)
}
K[k+1]=TRUE
if(PDF) dev.off()
} # k
} # Fig1
