# function for sampling ocean depths
source("https://github.com/sahirbhatnagar/EPIB607/raw/master/exercises/water/automate_water_task.R")

# from the in-class exercise
index.n.20 <- c(2106,2107,2108,2109,2110,2111,2112,
                2113,2114,2115,2116,2117,2118,2119,
                2120,2121,2122,2123,2124,2125)

# get depths of ocean sample n=20
depths.n.20 <- automate_water_task(index = index.n.20, 
                                   student_id = 260194225, type = "depth")

# change to 100m units
depths.n.20$alt = round(depths.n.20$alt/100,0)

library(mosaic)

# calculate mean depth for your sample
mean_depth <- mean(~ alt, data = depths.n.20)

# 10000 bootstrap samples
s_dist <- do(10000) * mean( ~ alt, data = resample(depths.n.20))

# 95% CI
CI_95 <- quantile(~ mean, data = s_dist, probs = c(0.025, 0.975))

# plot sampling distribution
hist(s_dist$mean, breaks = 50, col = "#56B4E9",
     main="",
     xlab = "mean depth of the ocean (100m) from each bootstrap sample")

# draw red line at the sample mean
abline(v = mean_depth, lty =1, col = "red", lwd = 4)

# draw black dotted lines at 95% CI
abline(v = CI_95[1], lty =2, col = "black", lwd = 4)
abline(v = CI_95[2], lty =2, col = "black", lwd = 4)

# include legend
library(latex2exp)
legend("topleft", 
       legend = c(TeX("$\\bar{y} = 36$"),
                  sprintf("95%% CI: [%.f, %.f]",CI_95[1], CI_95[2])), 
       lty = c(1,1), 
       col = c("red","black"), lwd = 4)