---
title: Midterm - October 29, 11:30am - 1:30pm 2018
author:
  - name: EPIB607 - Inferential Statistics
    affiliation: a
#  - name: Second Author
#    affiliation: a,b
address:
  - code: a
    address: Fall 2018, McGill University
#  - code: b
#    address: Department of Neat Tricks, Whereever State University, Someplace, MC, 67890
lead_author_surname: Bhatnagar and Hanley
doi: "https://sahirbhatnagar.com/EPIB607/"
abstract: |
  This is a 2 hour, open book exam. Calculators are permitted. Cellular phones are not permitted. The exam is out of 100. Write down all your answers in the provided booklet. Provide units and state your assumptions when applicable. If a question requires use of the z or t probabilites/quantiles, write the corresponding R code instead. Some commonly used quantiles are provided. 
# Optional: Acknowledgements
#acknowledgements: |
#  [rticles](https://cran.r-project.org/package=rticles) package, and both packages rely on the
#  [PNAS LaTeX](http://www.pnas.org/site/authors/latex.xhtml) macros. Both these sources are
#  ([GPL-3](https://www.gnu.org/licenses/gpl-3.0.en.html) and
#  [LPPL (>= 1.3)](https://www.latex-project.org/lppl/)).
# Optional: One or more keywords
keywords:
  - Descriptive statistics
  - Confidence intervals
  - p-values
  - Sampling distributions
  - Central Limit Theorem
  - z and t procedures
  - one sample mean
  - one sample proportion
papersize: letter
fontsize: 12pt
# Optional: Force one-column layout, default is two-column
one_column: true
# Optional: Enables lineno mode, but only if one_column mode is also true
#lineno: true
# Optional: Enable one-sided layout, default is two-sided
#one_sided: true
# Optional: Enable section numbering, default is unnumbered
numbersections: true
# Optional: Specify the depth of section number, default is 5
#secnumdepth: 5
# Optional: Skip inserting final break between acknowledgements, default is false
skip_final_break: true
# Optional: Bibliography 
bibliography: pinp
# Optional: Enable a 'Draft' watermark on the document
watermark: false
footer_contents: "Midterm - October 29, 11:30am - 1:30pm 2018"
output: pinp::pinp
# Required: Vignette metadata for inclusion in a package.
vignette: >
  %\VignetteIndexEntry{YourPackage-vignetteentry}
  %\VignetteKeywords{YourPackage, r, anotherkeyword}
  %\VignettePackage{Midterm - October 29, 11:30am - 1:30pm 2018}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---


```{r setup, echo=FALSE, message=FALSE, warning=FALSE}
library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
gg_sy <- theme(legend.position = "bottom", axis.text = element_text(size = 20),
                          axis.title = element_text(size = 20), 
                          legend.text = element_text(size = 20), 
                          legend.title = element_text(size = 20))

# A Prefix nulling hook.

# Make sure to keep the default for normal processing.
default_output_hook <- knitr::knit_hooks$get("output")

# Output hooks handle normal R console output.
knitr::knit_hooks$set( output = function(x, options) {

  comment <- knitr::opts_current$get("comment")
  if( is.na(comment) ) comment <- ""
  can_null <- grepl( paste0( comment, "\\s*\\[\\d?\\]" ),
                     x, perl = TRUE)
  do_null <- isTRUE( knitr::opts_current$get("null_prefix") )
  if( can_null && do_null ) {
    # By default R print output aligns at the right brace.
    align_index <- regexpr( "\\]", x )[1] - 1
    # Two cases: start or newline
    re <- paste0( "^.{", align_index, "}\\]")
    rep <- comment
    x <- gsub( re, rep,  x )
    re <- paste0( "\\\n.{", align_index, "}\\]")
    rep <- paste0( "\n", comment )
    x <- gsub( re, rep,  x )
  }

  default_output_hook( x, options )

})

knitr::opts_template$set("kill_prefix"=list(comment=NA, null_prefix=TRUE))

```

Some commong quantiles of the normal distribution and a nomogram for confidence intervals of a proportion are provided:

|R Code                     |       Value        |
|:--------------------------|:----------------------------------|
|`qnorm(p = c(0.05, 0.95))` |`r qnorm(p = c(0.05, 0.95))`    |
|`qnorm(p = c(0.025, 0.975))` |`r qnorm(p = c(0.025, 0.975))`    |
|`qnorm(p = c(0.005, 0.995))` |`r qnorm(p = c(0.005, 0.995))`    |



\begin{figure}[H]
  \begin{center}
\includegraphics[scale=0.65]{Nomogram.pdf}
  \end{center}
  \caption{\normalsize Wilson 95\% CIs for proportion $\pi$}\label{fig:nomo}
\end{figure}


\newpage



# Descriptive Statistics 


## (10 points, 2 each) Figure \ref{fig:fig1} below is a histogram of blood pressure in millimetres of mercury (mm) for all 14,148 women in the Contraceptive Drug Study at the Kaiser Clinic in Walnut Creek, California. Use the histogram to answer the following questions:

a. Is the percentage of women with blood pressures above 130 mm around 25%, 50% or, 75%?
b. Is the percentage of women with blood pressures between 90 mm and 160 mm around 1%, 50%, or 99%?
c. In which interval are there more women: 135-140 mm or 140-150 mm?
d. In the interval 125-130 mm, the height of the histogram is about 2.1% per mm. What percentage of the women had blood pressures in this class interval?
e. Which interval has more women: 97-98 mm or 102-103 mm?


\begin{figure}[h]
  \begin{center}
    \includegraphics[angle=90,scale=0.4]{bp-crop.pdf} 
  \end{center}
  \caption{\normalsize Distribution of blood pressure in millimetres of mercury (mm) for all 14,148 women in the Contraceptive Drug Study at the Kaiser Clinic in Walnut Creek, California.}\label{fig:fig1}
\end{figure}

\newpage


## (6 points, 2 each) Figure \ref{fig:fig2} are sketches of histograms for three lists. 

a. In scrambled order, the averages are 40, 50, 60. Match the histograms with the averages.
b. Is the SD of histogram (iii) around 5, 15, or 50?
c. True or false, and explain: The SD for histogram (i) is a lot smaller than that for histogram (iii).


\begin{figure}[h]
  \begin{center}
    \includegraphics[angle=90,scale=0.4]{hist-crop.pdf} 
    \caption{\normalsize Sketches of histograms for three lists.}\label{fig:fig2}
\end{center}
\end{figure}


```{r, eval=FALSE, echo=FALSE}
set.seed(10234)
par(mfrow=c(1,2))
x <- rweibull(10000, 4, 2) 
y <- rweibull(10000, 1.5, 1)
xlims <- range(x-1,y+1)
x %>% hist(breaks=30, main = "long left tail", xlim = xlims)
y %>% hist(breaks=30, main = "long right tail", xlim = xlims)
favstats(x)
favstats(y)
abline(v = mean(y), col = "red")
abline(v = mean(y)+sd(y), col = "red")
```



\newpage

## (5 points, 2.5 each) Breast-feeding mothers secrete calcium into their milk. Some of the calcium may come from their bones, so mothers may lose bone mineral content. Researchers compared 47 breast-feeding women with 22 women of similar age who were neither pregnant nor lactating. They measured the percent change in the mineral content of the women's spines over three months. A negative value of `mineral_loss` indicates a loss in mineral content. Consider this box plot of the mineral loss by group:

```{r, echo=F, eval=TRUE, warning=FALSE, message=FALSE, fig.dim=c(6, 4)}
boneloss <- read.csv("https://github.com/sahirbhatnagar/EPIB607/raw/master/data/boneloss.csv")
library(mosaic)
ggformula::gf_boxplot(mineral_loss ~ type, data = boneloss) + theme_linedraw() + gg_sy + xlab("group") + ylab("mineral loss")
# mosaic::IQR(mineral_loss ~ type, data = boneloss)
```

a. The interquartile range for the breast-feeding group is approximately (select one answer from the following options):
    - [-2, -5.3]
    - 3.2
    - [-8, 2]
    - 10
b. The median mineral loss for the other group is (select one answer from the following options):
    - approximately equal to the mean
    - less than the mean
    - greater than the mean
    - there is not enough information in the plot to know


\newpage

## (8 points, 4 each) Stephen Jay Gould's book "The Mismeasure of Man" discusses a table from a 1978 article by Epstein reproduced in Table \ref{tab:gould}. Gould read the original article and found that Epstein's original table, reproduced below, reveals that the \textit{SE} column had been copied and re-labelled \textit{SD}. Then, using this SD, and the $n$, Epstein was able to show that the CI's for mean head circumference for people of varied vocational statuses did not overlap, and thus that there were "statistically significant" inter-group differences.

\begin{table}[h]
\begin{center}
\begin{tabular}{lrcc}
\hline
\normalsize Vocational Status & \normalsize  N & \normalsize  Mean (in mm) &\normalsize  SD \\
\hline
\normalsize Professional  &\normalsize  25 &\normalsize  569.9 &\normalsize  1.9 \\
\normalsize Semiprofessional & \normalsize 61& \normalsize 566.5 & \normalsize 1.5 \\
\normalsize Clerical &\normalsize 107 &\normalsize 566.2 & \normalsize 1.1 \\
\normalsize Trades &\normalsize 194 & \normalsize 565.7 &\normalsize  0.8 \\
\normalsize Public service & \normalsize 25 & \normalsize 564.1 & \normalsize 2.5 \\
\normalsize Skilled trades & \normalsize 351 & \normalsize 562.9 & \normalsize 0.6 \\
\normalsize Personal services & \normalsize 262 & \normalsize 562.7 & \normalsize 0.7 \\
\normalsize Laborers & \normalsize 647 & \normalsize 560.7 & \normalsize 0.3 \\
\hline
\end{tabular}
\end{center}
\caption{Head circumferences in mm for people of varied vocational statuses}\label{tab:gould}
\end{table}

a. How did Gould figure out that Epstien relabelled the SE column to SD?
b. Based on the table, what would be a reasonable SD for inter-individual headsizes?








\newpage


# Confidence Intervals, P-values


## (9 points) One term at McGill University, 400 students took the final in the "Advanced Statistics" course. Their scores averaged 65.3 out of 100, and the SD was 25. You are given that $\sqrt{400} \times 25=500$ and $500/400=1.25$

a. What is the parameter of interest?
b. Provide the `R` code to calculate a 95\% confidence interval for the parameter of interest.
c. The corresponding sampling distribution is shown in Figure \ref{fig:samp}. Provide an approximate 95% confidence interval.


```{r samp, results='hide', fig.cap='sampling distribution', fig.dim=c(6.5, 4.4), message=FALSE, echo=FALSE}
mosaic::xqnorm(p = c(0.025, 0.975), mean = 65.3, sd = 1.25, return = "plot") + 
  theme_bw() + scale_fill_manual(values = c("black","grey60", "black")) + 
  scale_x_continuous(breaks = seq(59, 71, .5)) + theme(legend.position = "bottom")
```



\newpage

## (6 points, 2 each) In a recent Vox article, author Brian Resnick attempts to describe what a p-value is. Here are some excerpts from the article. For each one, indicate whether the statement is TRUE or FALSE. If the statement is FALSE, briefly explain why

1. When researchers calculate a p-value, they're putting to the test what's known as the null hypothesis. First thing to know: This is not a test of the question the experimenter most desperately wants to answer.
2. Let's say the experimenter really wants to know if eating one bar of chocolate a day leads to weight loss. To test that, they assign 50 participants to eat one bar of chocolate a day. Another 50 are commanded to abstain from the delicious stuff. Both groups are weighed before the experiment, and then after, and their average weight change is compared. The null hypothesis is the devil's advocate argument. It states: There is no difference in the weight loss of the chocolate eaters versus the chocolate abstainers.
3. So how do they reject the null hypothesis? They calculate some statistics. The researcher basically asks: How ridiculous would it be to believe the null hypothesis is the true answer, given the results we're seeing?


## (10 points) New laser altimeters can measure elevation to within a few inches, without bias, and with no trend or pattern to the measurements. As part of an experiment, 25 readings were made on the elevation of a mountain peak. Their mean was 81,411 inches, and their SD was 30 inches. Fill in the blanks in part (a), then say whether each of (b-e) is true or false; explain your answers briefly. (You may assume Gaussian variation of the measurements, with no bias)

a. The elevation of the mountain peak is estimated as __________ . There is approximately a ______ % chance that we are over-estimating or under-estimating the true elevation by more than 6 inches.
b. 81,411 $\pm$ 12 inches is a 95%-confidence interval for the average of the 25 readings.
c. 81,411 $\pm$ 12 inches is a 95%-confidence interval for the elevation of the mountain peak.
d. A large majority of the 25 readings were in the range 81,411 $\pm$ 12 inches.
e. The elevation of the mountain peak is the statistic here; the 81,411 is a parameter.


\newpage


# One-sample mean 


## (8 points) The US presidential campaign is now gathering pace, with all the customary razzmatazz. Much time and trouble could be saved, however, if the candidates simply had their height measured: with one exception, the President has always been the taller candidate. Tall people are credited with qualities expected of capable people

a. State the null hypothesis against which you can statistically test the claim.
b. There are a few ways to test this; what test statistic you would use?
c. What reference distribution will your use to describe the sampling variation of the test statistic under the null hypothesis? 
d. The number of elections on which the data are based is not given, but say for the sake of this exercise that it is 50. Carry out the statistical test and provide a statement regarding your findings. 



## (10 points) A colony of laboratory mice consisted of several hundred animals. Their average weight was 30g, with a standard deviation of 5g. As part of an experiment, graduate students were instructed to choose 25 animals; no definite method of selection was specified in the instructions to the students. The average weight of the 25 animals selected by the students was 33 grams

a. Was the method of choosing animals used by the graduate student equivalent to drawing animals at random? Discuss briefly, carefully formulating the hypotheses and performing a test of significance with a Type I error rate of 5%.
b. Provide the `R` code needed to calculate a 99% confidence interval for the true mean weight in the population generated by the selection method used by the student.
c. What sample size would be required to obtain a 95% confidence interval of width 2g?


\newpage



# One-sample proportion



## (10 points) To allow for the 10% (on average) of people who make reservations but do not show up for their flights, an airline company "over-books", i.e., it takes reservations for up to 145 seats when it only has space on the plane for 140 passengers. 

a. If the airline takes 145 reservations, what is the probability that it will not have a seat for every passenger who shows up? State your assumptions and provide the `R` code to calculate this probability.
b. Would the normal distribution be appropriate here? Why or why not?
c. Suppose that some of the 145 individuals are related. Does this affect the appropriateness of the probability model you base your calculations on? Why or why not?


## (10 points) The abstract from the article "Does the newborn baby find the nipple by smell?" by Varendo H et al., (Lancet 1994) writes: "We studied the involvement of naturally occurring odours in guiding the baby to the nipple. One breast of each participating mother was washed immediately after delivery. The newborn infant was placed prone between the breasts. Of 25 infants, 20 spontaneously selected the unwashed breast. The washing procedure had no effect on breast temperature. We concluded that the infants responded to olfactory (sense of smell) differences between the washed and unwashed breasts". 

a. What is the parameter at issue here?
b. State the implied null and alternative hypotheses concerning this parameter. 
c. What is the statistic reported? 
d. What null distribution should be used to test the hypothesis?
e. Calculate a 95% confidence interval for the parameter at issue. 
f. A similar study is conducted at a different hopital. Of 100 infants, 80 spontaneously selected the unwashed breast. Do you expect the same confidence limits as those obtained in part (e) ? Why or why not?




\newpage







# Power for one-sample mean

## (10 points) You are aware that students writing statistics exams have enough to worry about without their calculators failing, so you try to develop a calculator battery that lasts longer than typical batteries. The lifetime of typical batteries is Normally distributed with mean 180.2 minutes, with a known standard deviation of 8.3 minutes. Your new battery also appears to have a lifetime that is Normally distributed with a standard deviation of 8.3 minutes. You want to test whether the new battery is significantly better, and opt for the more conservative, two-sided test with a Type I error rate of 0.01. Using a sample of size 14, you find that your batteries last 186.1 minutes on average. (If you need the $z$ or $t$ probabilities/quantiles, provide the corresponding `R` code needed for that calculation)

a. Is there evidence that your new batteries are different from the old batteries? State your hypothesis, provide a confidence interval and a p-value, and summarize your results.
b. Assume your answer in part (a) results in a p-value of 0.008. Explain what this p-value means.
c. Find the power of a 1% significance test against the alternative $\mu = 190$ minutes. 
d. At a 1% level of significance, find the probability of a Type II error when the alternative is $\mu = 182$.
e. What sample size is required to detect a difference of 3 minutes at a 1% level of significance with 90% power (two-sided alternative)?




# Bootstrap


## (10 points) Verizon was an Incumbent Local Exchange Carrier (ILEC), responsible for maintaining land-line phone service in certain areas. Verizon also sold long-distance service, as did a number of competitors, termed Competitive Local Exchange Carriers (CLEC). When something went wrong, Verizon was responsible for repairs, and was supposed to make repairs as quickly for CLEC long-distance customers as for their own. The New York Public Utilities Commission monitored fairness by comparing repair times for Verizon and different CLECs, for different classes of repairs and time periods. The results (in minutes) for a specific class of repairs is shown in the Table \ref{tab:tab2}. You decide to independently draw 10,000 bootstrap samples with replacement from each sample (ILEC and CLEC), and compute the mean repair time (in minutes) for each bootstrap sample. You then calculate the bootstrap standard deviation from the 10,000 bootstrap samples, separately for ILEC and CLEC

\begin{table}[H]
\begin{center}
\begin{tabular}{lrcc}
\hline
\normalsize Carrier  &\normalsize  n  &\normalsize  mean &\normalsize  SD\\
\hline
\normalsize ILEC  &\normalsize  1664 &\normalsize  8.41 &\normalsize  16.5\\
\normalsize CLEC  &\normalsize  23 &\normalsize  16.69 &\normalsize  19.5\\
\hline
\end{tabular}
\end{center}
\caption{Repair times (in minutes)}\label{tab:tab2}
\end{table}



a. Would the bootstrap SD for ILEC be larger, smaller or approximately similar to the SD presented in \mbox{Table \ref{tab:tab2}} for ILEC? Explain
b. Would the bootstrap SD for CLEC be larger, smaller or approximately similar to the SD presented in \mbox{Table \ref{tab:tab2}} for CLEC? Explain
c. Would the bootstrap SD for ILEC be larger, smaller or approximately similar to the bootstrap SD for CLEC? Explain
d. Do you expect the bootstrap to give a very different 95% confidence interval (for either carrier) compared to the one obtained by the $z$ procedure? Why or why not?


































<!--
2. The bootstrap distribution is centered at the observed statistic,
not the population parameter, for example, at x, not .
This has two profound implications. First, it means that we do
not use the mean of the bootstrap statistics as a replacement for
the original estimate.1 For example, we cannot use the bootstrap
to improve on x; no matter how many bootstrap samples we take, they are centered at x, not . Instead we use the bootstrap
to tell how accurate the original estimate is. In this regard the
bootstrap is like formula methods that use the data twiceâ€”once
to compute an estimate, and again to compute a standard error
for the estimate. The bootstrap just uses a different approach to
estimating the standard error.
-->

<!--Not a confidence interval. For one thing, we don't know what chance process it uses. This is a sample of convenience not a simple random sample.-->

<!-- 
We support several options via the YAML header

- Setting a DOI or URL footer, for example for the CRAN package URL,
  which is placed in the bottom-left footer of the title page and even pages;
- Setting a footer label, for example _YourPackage Vignette_ stating
  your package, which is placed in the bottom-right footer on odd
  pages;
- Setting a free-form author field used on the inside footer;
- Optional _Draft_ watermarking;



## References 

Here we differ from PNAS and suggest natbib. References will appear in
author-year form. Use `\citet{}`, `\citep{}`, etc as usual.

We default to the `jss.bst` style. To switch to a different bibliography
style, please use `biblio-style: style` in the YAML header.


## Inline R Code 

The PNAS sample included a fixed PNG image here, but this document prefers
to show the results and embedding of _R_ code. 

```{r figex, fig.width=3, fig.height=3, cache=TRUE, echo=TRUE, fig.cap="Narrow ggplot2 figure"}
library(ggplot2)
ggplot(mtcars, aes(wt, mpg)) +
    geom_point(size=3, aes(colour=factor(cyl))) +
    theme(legend.position="none")
```

Here we use a standard knitr bloc with explicit options for

- figure width and height (`fig.width`, `fig.height`), both set to three inches;
- whether the code is shown (`echo=TRUE`); and
- the caption (`fig.cap`) as shown above.


## Digital Figures 

Markdown, Pandoc and LaTeX support `.eps` and `.pdf` files.

Figures and Tables should be labelled and referenced in the standard way
using the `\label{}` and `\ref{}` commands.

The R examples above show how to insert a column-wide
figure. To insert a figure wider than one column, please use the
`\begin{figure*}...\end{figure*}` environment. 

One (roundabout) way of doing this is to _not_ actually plot a figure, but to
save it in a file as the following segment shows:

```{r densityPlot, echo=TRUE, eval=FALSE}
library(ggplot2)
p <- ggplot(data = midwest,
            mapping = aes(x = area,
                          fill = state,
                          color = state)) +
    geom_density(alpha = 0.3)
## save to file
suppressMessages(ggsave("densities.pdf", p))
```

This file is then included via standard LaTeX commands.

\begin{figure*}
  \begin{center}
    \includegraphics[width=0.66\textwidth, height=3.5in]{densities} 
  \end{center}
  \caption{Wide ggplot2 figure}\label{fig}
\end{figure*}


## Typeset Code (But Do Not Run It) 

We can also just show code.

```r
xx <- faithful[,"eruptions"]
fit <- density(xx)
plot(fit)
```

This simply used a pandoc bloc started and ended by three backticks,
with `r` as the language choice.  Similarly, _many_ other languages
can be typeset directly simply by relying on pandoc.


## Single column equations 

Authors may use 1- or 2-column equations in their article, according to
their preference.

To allow an equation to span both columns, options are to use the
`\begin{figure*}...\end{figure*}` environment mentioned above for
figures, or to use the `\begin{widetext}...\end{widetext}` environment
as shown in equation \ref{eqn:example} below.

Please note that this option may run into problems with floats and
footnotes, as mentioned in the [cuted package
documentation](http://texdoc.net/pkg/cuted). In the case of problems
with footnotes, it may be possible to correct the situation using
commands `\footnotemark` and `\footnotetext`.

\begin{equation}
  \begin{aligned}
(x+y)^3&=(x+y)(x+y)^2\\
       &=(x+y)(x^2+2xy+y^2) \\
       &=x^3+3x^2y+3xy^3+x^3. 
       \label{eqn:example} 
  \end{aligned}
\end{equation}


pandoc writes all tables using longtable, which fails in 2-column mode

  Species                    CBS     CV     G3
  ----------------------- ------ ------ ------
  1\. Acetaldehyde           0.0    0.0    0.0
  2\. Vinyl alcohol          9.1    9.6   13.5
  3\. Hydroxyethylidene     50.8   51.2   54.0

  : Comparison of the fitted potential energy surfaces and ab initio
  benchmark electronic energy calculations

-->

